services:
  dotnetcameroon.sqlserver:
    image: mcr.microsoft.com/mssql/server:2022-latest
    container_name: dotnetcameroon.sqlserver
    user: root
    hostname: sqlserver
    environment:
      ACCEPT_EULA: "Y"
      MSSQL_SA_PASSWORD: "@Passw0rd"
      MSSQL_PID: "Evaluation"
    ports:
      - "1433:1433"
    volumes:
      - sqlserver-data:/var/opt/mssql
    healthcheck:
      test: [
        "CMD-SHELL", 
        "/opt/mssql-tools18/bin/sqlcmd -S localhost -U SA -P '@Passw0rd' -Q 'SELECT 1' -C || exit 1"
      ]
      interval: 30s
      timeout: 10s
      retries: 5
      start_period: 30s
  dotnetcameroon.dashboard:
    image: mcr.microsoft.com/dotnet/nightly/aspire-dashboard:latest
    container_name: dotnetcameroon.dashboard
    environment:
      DASHBOARD__OTLP__AUTHMODE: 'ApiKey'
      DASHBOARD__OTLP__PRIMARYAPIKEY: 'buhkyb-zasros-7Nevpy'
    ports:
      - 18888:18888
volumes:
  sqlserver-data:
